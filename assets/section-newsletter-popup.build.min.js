const n={newsletterPopup:"NewsletterPopup",newsletterPopupToggle:"NewsletterPopupToggle",newsletterPopupFormInput:"newsletter-popup-contact-form-input",form:"newsletter-popup-contact-form",input:".js-newsletter-popup-input"},T={posted:"posted"},y=()=>{const m=window.themeCore.utils.Toggle,a=window.themeCore.utils.setCookie,g=window.themeCore.utils.getCookie,f=window.themeCore.utils.cssClasses;let t,i,l,r,o;function h(){if(t=document.getElementById(n.newsletterPopup),i=document.getElementById(n.form),l=document.querySelector(n.input),!t&&Shopify.designMode){const s=document.querySelector("[data-js-overlay='NewsletterPopupToggle']");document.body.classList.remove("blur-content"),s&&s.click()}if(!t||!i||!l)return!1;let e=u()?0:6e3;o=setTimeout(p,e),window.themeCore.EventBus.listen("create:newsletter:popup",()=>{o&&clearTimeout(o),o=setTimeout(p,e)}),window.themeCore.EventBus.listen("destroy:newsletter:popup",w)}function p(){let e=window.location.pathname.includes("challenge");g("newsletter_popup")||e||window.themeCore.ageCheckPopupOpen||(r||(r=m({toggleSelector:n.newsletterPopupToggle}),r.init()),r.open(t),t.addEventListener("click",s=>{t.firstElementChild.contains(s.target)||window.themeCore.EventBus.emit(`Toggle:${n.newsletterPopupToggle}:close`)}),P(),u()&&c(),C()&&(t.classList.add(f.current),l&&l.focus()))}function P(){window.themeCore.EventBus.listen(`Toggle:${n.newsletterPopupToggle}:close`,()=>{w(),c()})}function u(){let e=document.getElementById(n.newsletterPopupFormInput);return!(!e||!e.classList.contains(T.posted))}function c(){if(!t.hasAttribute("data-cookie-time"))return;let s=t.dataset.cookieTime*24*60*60;a("newsletter_popup","1",{"max-age":s})}function C(){return!window.location.hash||window.location.hash==="#newsletter-popup-contact-form"}function w(){if(o&&(clearTimeout(o),o=null),Shopify.designMode){const e=document.querySelector("[data-js-overlay='NewsletterPopupToggle']");document.body.classList.remove("blur-content"),e&&e.click()}}return Object.freeze({init:h})},d=()=>{window.themeCore.NewsletterPopup=window.themeCore.NewsletterPopup||y(),window.themeCore.utils.register(window.themeCore.NewsletterPopup,"newsletter-popup")};window.themeCore&&window.themeCore.loaded?d():document.addEventListener("theme:all:loaded",d,{once:!0});
