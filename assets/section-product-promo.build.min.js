const i={section:".js-product-promo",buttonQuickView:".js-product-promo-quick-view-button",buttonClose:".js-product-promo-quick-view-button-close",main:"#MainContent"},E=()=>{const u=window.themeCore.utils.setCookie,d=window.themeCore.utils.getCookie,m=window.themeCore.utils.cssClasses,w=6e3;let t,n,r,c;function C(){if(t=document.querySelector(i.section),!t)return!1;n=t.dataset.handle,r=t.dataset.variantId,c=t.dataset.variantCount,setTimeout(P,w),p()}function l(){if(!t.hasAttribute("data-cookie-time"))return;let o=t.dataset.cookieTime*24*60*60;u("product_promo","1",{"max-age":o})}function p(){t.addEventListener("click",e=>{if(e.target.closest(i.buttonQuickView)){h(),a();return}e.target.closest(i.buttonClose)&&a()})}function h(){c>1?v():f()}async function f(){try{const e={id:r,quantity:1};t&&t.hasAttribute("data-preorder")&&(e.properties=e.properties||{},e.properties["_Pre-order"]="true"),await window.themeCore.CartApi.makeRequest(window.themeCore.CartApi.actions.ADD_TO_CART,e),await window.themeCore.CartApi.makeRequest(window.themeCore.CartApi.actions.GET_CART)}catch(e){k(e)}}function k(e){const o=window.themeCore.CartNotificationError;o.addNotification(e.description),o.open()}function v(){const e=document.querySelector(i.main);window.themeCore.EventBus.emit("product-card:quick-view:clicked",{productHandle:n,variant:r,showDescription:!0,focusTarget:e})}function a(){l(),t.remove()}function P(){d("product_promo")||t.classList.remove(m.hidden)}return Object.freeze({init:C})},s=()=>{window.themeCore.ProductPromo=window.themeCore.ProductPromo||E(),window.themeCore.utils.register(window.themeCore.ProductPromo,"product-promo-popup")};window.themeCore&&window.themeCore.loaded?s():document.addEventListener("theme:all:loaded",s,{once:!0});
